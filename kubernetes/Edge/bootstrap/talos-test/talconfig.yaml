---
clusterName: edge
talosVersion: v1.7.5
kubernetesVersion: v1.30.2
endpoint: https://172.16.1.101:6443
domain: cluster.local
allowSchedulingOnMasters: true
clusterPodNets:
  - 10.245.0.0/16
clusterSvcNets:
  - 10.246.0.0/16
nodes:
  - hostname: test-01
    ipAddress: 172.16.1.101
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.16.1.1
    networkInterfaces:
      - interface: eth0
        addresses:
          - 172.16.1.101/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.1.1
  - hostname: test-02
    ipAddress: 172.16.1.102
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.16.1.1
    networkInterfaces:
      - interface: eth0
        addresses:
          - 172.16.1.102/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.1.1
  - hostname: test-03
    ipAddress: 172.16.1.103
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.16.1.1
    networkInterfaces:
      - interface: eth0
        addresses:
          - 172.16.1.103/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.1.1
controlPlane:
  schematic:
    customization:
      extraKernelArgs:
        - net.ifnames=0
      systemExtensions:
          officialExtensions:
              - siderolabs/i915-ucode
              - siderolabs/iscsi-tools
              - siderolabs/util-linux-tools
              - siderolabs/qemu-guest-agent
  patches:
    - |-
      - op: add
        path: /machine/kubelet/extraArgs
        value:
          rotate-server-certificates: "true"
    - "@./patches/etcd-api-access.yaml"
    - "@./patches/kubespan.yaml"
    - "@./patches/cluster-discovery.yaml"
    - "@./patches/cni.yaml"
    - "@./patches/coredns.yaml"