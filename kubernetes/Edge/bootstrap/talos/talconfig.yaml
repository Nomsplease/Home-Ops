---
clusterName: Edge
talosVersion: v1.7.5
kubernetesVersion: v1.30.2
endpoint: https://172.16.1.20:6443
domain: cluster.local
allowSchedulingOnMasters: true
clusterPodNets:
  - 10.245.0.0/16
clusterSvcNets:
  - 10.246.0.0/16
nodes:
  - hostname: Edge-Int-01
    ipAddress: 172.16.1.20
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.16.1.1
    networkInterfaces:
      - interface: enp1s0
        addresses:
          - 172.16.1.20/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.1.1
  - hostname: Edge-Int-02
    ipAddress: 172.16.1.21
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.16.1.1
    networkInterfaces:
      - interface: enp1s0
        addresses:
          - 172.16.1.21/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.1.1
  - hostname: Edge-Par-01
    ipAddress: 172.18.1.20
    controlPlane: true
    installDiskSelector:
      size: '< 100GB'
    nameservers:
      - 172.18.1.1
    networkInterfaces:
      - interface: enp1s0
        addresses:
          - 172.18.1.20/24
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 172.18.1.1
controlPlane:
  schematic:
    customization:
      extraKernelArgs:
        - net.ifnames=0
      systemExtensions:
          officialExtensions:
              - siderolabs/i915-ucode
              - siderolabs/iscsi-tools
              - siderolabs/util-linux-tools
              - siderolabs/qemu-guest-agent
  patches:
    - |-
      - op: add
        path: /machine/kubelet/extraArgs
        value:
          rotate-server-certificates: "true"
    - "@./patches/etcd-api-access.yaml"
    - "@./patches/kubespan.yaml"
    - "@./patches/cluster-discovery.yaml"